<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <!-- Google Tag Manager - PM è¿½è¹¤ä»£ç¢¼ -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-N8VL4XS');</script>
    <!-- End Google Tag Manager -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¬°å…’ç¡çœ å®‰å…¨å®ˆè­·è€…ï¼šç ´é™¤è‡´å‘½è¿·æ€</title>
    
    <!-- ä½¿ç”¨ Tailwind CSS åŠ é€Ÿæ¸²æŸ“ -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        :root {
            --baby-pink: #fbcfe8;
            --baby-yellow: #fef08a;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fffaf0;
            margin: 0;
            padding: 0;
        }

        /* æ ¸å¿ƒå‹•ç•« */
        @keyframes sway { 0% { transform: rotate(-3deg); } 100% { transform: rotate(3deg); } }
        .mobile-swing { transform-origin: top center; animation: sway 3s ease-in-out infinite alternate; }
        .mobile-swing-active { animation-duration: 2s; }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        .baby-float { animation: float 3s ease-in-out infinite; }

        @keyframes heartUp {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-40px) scale(1.2); opacity: 0; }
        }
        .heart-icon { animation: heartUp 1.5s ease-out infinite; opacity: 0; }

        @keyframes tearDrop {
            0% { transform: translateY(0); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translateY(25px); opacity: 0; }
        }
        .tear-drop { animation: tearDrop 1s ease-in infinite; opacity: 0; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }
        .is-crying { animation: shake 0.2s infinite; }

        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .btn-bounce:active { transform: scale(0.96); transition: 0.1s; }
        
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: var(--baby-pink); border-radius: 10px; }

        .music-pulse { animation: pulse 2s infinite; }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(244, 114, 182, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(244, 114, 182, 0); }
            100% { box-shadow: 0 0 0 0 rgba(244, 114, 182, 0); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-2 sm:p-4">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N8VL4XS"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <!-- éŸ³æ¨‚é–‹é—œ -->
    <button id="music-toggle" onclick="toggleMusic()" class="fixed top-4 right-4 z-50 bg-white p-2.5 rounded-full shadow-lg border-2 border-pink-100 text-lg">
        <span id="music-icon">éœéŸ³</span>
    </button>

    <div id="game-container" class="w-full max-w-md bg-white rounded-[2rem] shadow-2xl overflow-hidden border-b-8 border-pink-200 relative flex flex-col h-[600px] sm:h-auto">
        
        <!-- éŸ³æ¨‚éˆ´ -->
        <div class="w-full flex justify-center pt-3 shrink-0">
            <svg id="bed-mobile" class="mobile-swing" width="100" height="50" viewBox="0 0 120 80">
                <line x1="60" y1="0" x2="60" y2="20" stroke="#fbcfe8" stroke-width="2"/>
                <line x1="20" y1="40" x2="100" y2="40" stroke="#fbcfe8" stroke-width="2"/>
                <circle cx="60" cy="40" r="3" fill="#fbcfe8"/>
                <line x1="20" y1="40" x2="20" y2="60" stroke="#fbcfe8" stroke-width="1"/>
                <path d="M15 65 L20 60 L25 65 L20 75 Z" fill="#fef08a"/>
                <line x1="100" y1="40" x2="100" y2="60" stroke="#fbcfe8" stroke-width="1"/>
                <path d="M95 65 Q105 65 105 75 Q95 75 95 65" fill="#fbcfe8"/>
                <line x1="60" y1="40" x2="60" y2="70" stroke="#fbcfe8" stroke-width="1"/>
                <path d="M55 70 A5 5 0 1 1 65 70 A5 5 0 1 0 55 70" fill="#fde047"/>
            </svg>
        </div>

        <!-- å¯¶å¯¶è¦–è¦º -->
        <div id="baby-display" class="flex justify-center mb-2 shrink-0">
            <div id="baby-wrapper" class="relative baby-float">
                <div id="hearts-layer" class="hidden absolute -top-8 inset-x-0 flex justify-around px-4 pointer-events-none">
                    <span class="heart-icon text-pink-400 text-lg">â¤ï¸</span>
                    <span class="heart-icon text-pink-300 text-base" style="animation-delay: 0.3s">â¤ï¸</span>
                </div>
                <svg width="150" height="100" viewBox="0 0 200 120" class="mx-auto">
                    <rect x="20" y="80" width="160" height="10" rx="5" fill="#f3f4f6"/>
                    <rect x="30" y="70" width="140" height="10" rx="2" fill="#fff"/>
                    <g id="baby-body">
                        <rect x="85" y="55" width="30" height="25" rx="10" fill="#fbcfe8"/>
                        <circle cx="100" cy="50" r="18" fill="#ffe4e6"/>
                        <g id="eyes-neutral">
                            <path d="M90 48 Q93 51 96 48" stroke="#f472b6" fill="none" stroke-width="1.5"/>
                            <path d="M104 48 Q107 51 110 48" stroke="#f472b6" fill="none" stroke-width="1.5"/>
                        </g>
                        <g id="eyes-happy" class="hidden">
                            <circle cx="93" cy="48" r="2.5" fill="#db2777"/>
                            <circle cx="107" cy="48" r="2.5" fill="#db2777"/>
                        </g>
                        <g id="eyes-sad" class="hidden">
                            <path d="M90 50 L96 46 M90 46 L96 50" stroke="#9d174d" fill="none" stroke-width="1.5"/>
                            <path d="M104 50 L110 46 M104 46 L110 50" stroke="#9d174d" fill="none" stroke-width="1.5"/>
                        </g>
                        <path id="mouth-neutral" d="M97 58 Q100 60 103 58" stroke="#f472b6" fill="none" stroke-width="1"/>
                        <path id="mouth-happy" d="M95 56 Q100 62 105 56" stroke="#db2777" fill="none" stroke-width="2" class="hidden"/>
                        <circle id="mouth-sad" cx="100" cy="60" r="3" fill="#9d174d" class="hidden"/>
                        <g id="tears-layer" class="hidden">
                            <circle cx="90" cy="55" r="2" fill="#60a5fa" class="tear-drop"/>
                            <circle cx="110" cy="55" r="2" fill="#60a5fa" class="tear-drop" style="animation-delay: 0.5s"/>
                        </g>
                    </g>
                </svg>
            </div>
        </div>

        <div class="flex-1 overflow-hidden relative">
            <!-- ç•«é¢ 1: é–‹å§‹æŒ‘æˆ° -->
            <div id="start-screen" class="p-6 text-center h-full flex flex-col justify-center">
                <h1 class="text-2xl font-extrabold text-gray-800 mb-2">å®‰å…¨ç¡çœ å®ˆè­·è€…æŒ‘æˆ°</h1>
                <p class="text-pink-500 font-bold mb-4">ä½ èƒ½ç²å¾—ä»€éº¼å®ˆè­·ç¨±è™Ÿï¼Ÿ</p>
                <div class="text-gray-600 mb-6 space-y-2 text-left bg-pink-50 p-4 rounded-2xl text-sm border border-pink-100">
                    <p class="flex items-start"><span class="mr-2">ğŸ‘¶</span> å°ç£æ¯å¹´ç´„æœ‰ 30 åå¬°å…’çŒæ­»ã€‚</p>
                    <p class="flex items-start"><span class="mr-2">ğŸ </span> 10 é“é—œéµé¡Œï¼Œå¯¦æ¸¬ä½ çš„ç¡çœ å®‰å…¨ç­‰ç´šã€‚</p>
                    <p class="flex items-center text-pink-600 font-bold">
                        <span class="mr-2">âœ¨</span> å·²æœ‰ <span id="count-value" class="mx-1">1,248</span> ä½å®ˆè­·è€…åƒèˆ‡æŒ‘æˆ°
                    </p>
                </div>
                <button onclick="startGame()" class="w-full bg-yellow-400 hover:bg-yellow-500 text-yellow-900 font-bold py-3.5 rounded-2xl shadow-lg btn-bounce text-lg">
                    é–‹å§‹æŒ‘æˆ°
                </button>
            </div>

            <!-- ç•«é¢ 2: æ¸¬é©—é€²è¡Œ -->
            <div id="quiz-screen" class="hidden p-5 pt-0 h-full flex flex-col">
                <div class="mb-4 shrink-0">
                    <div class="flex justify-between items-end mb-2">
                        <span id="progress-text" class="text-xs font-bold text-pink-500">é€²åº¦ 1 / 10</span>
                        <span id="score-text" class="text-sm font-bold text-gray-700">å¾—åˆ†: 0</span>
                    </div>
                    <div class="w-full bg-gray-100 h-2 rounded-full overflow-hidden">
                        <div id="progress-bar" class="h-full bg-pink-400 transition-all duration-300" style="width: 10%"></div>
                    </div>
                </div>
                
                <div id="quiz-content" class="flex-1 overflow-y-auto custom-scroll pr-1">
                    <div id="question-container" class="fade-in">
                        <div class="bg-yellow-50 p-4 rounded-2xl mb-4 border border-yellow-100">
                            <h2 id="question-text" class="text-base font-bold text-gray-800 text-center leading-snug">è¼‰å…¥ä¸­...</h2>
                        </div>
                        <div id="options-container" class="space-y-2.5 mb-4"></div>
                    </div>

                    <div id="feedback-container" class="hidden p-4 rounded-2xl border-2 fade-in bg-white mb-4">
                        <div class="flex items-center mb-2">
                            <div id="feedback-icon" class="mr-2 text-xl"></div>
                            <p id="feedback-title" class="font-bold text-base"></p>
                        </div>
                        <p id="feedback-text" class="text-gray-700 text-xs sm:text-sm leading-relaxed mb-4"></p>
                        
                        <!-- é—œè¯å»¶ä¼¸é–±è®€ -->
                        <div id="inline-article" class="hidden mb-4">
                            <div class="bg-pink-50 rounded-xl p-3 border border-pink-100">
                                <p class="text-[10px] font-bold text-pink-400 mb-1">ğŸ’¡ å°ˆå®¶å»ºè­°è©³è®€ï¼š</p>
                                <a id="article-link" href="#" target="_blank" class="text-xs sm:text-sm font-bold text-gray-800 hover:text-pink-600 underline leading-tight block"></a>
                            </div>
                        </div>

                        <button onclick="nextQuestion()" class="w-full bg-pink-500 text-white font-bold py-3 rounded-xl shadow-md btn-bounce">ä¸‹ä¸€é¡Œ</button>
                    </div>
                </div>
            </div>

            <!-- ç•«é¢ 3: çµæœçµç®— -->
            <div id="result-screen" class="hidden p-6 text-center h-full overflow-y-auto custom-scroll">
                <h2 class="text-xl font-bold text-gray-800 mb-1">æŒ‘æˆ°çµæœ</h2>
                <div class="my-4 bg-pink-50 p-5 rounded-3xl border-2 border-pink-100 relative">
                    <p class="text-[10px] text-pink-400 font-bold mb-1 tracking-widest uppercase">æœ€çµ‚å¾—åˆ†</p>
                    <div class="mb-2"><span id="final-score" class="text-5xl font-black text-pink-500">0</span><span class="text-gray-400 text-lg"> / 1000</span></div>
                    <div id="rank-badge" class="inline-block px-5 py-1.5 rounded-full bg-white shadow-sm border-2 font-black text-lg mb-2">è¼‰å…¥ä¸­...</div>
                    <p id="rank-desc" class="text-gray-600 text-xs font-medium px-2"></p>
                </div>
                <div id="result-message" class="text-gray-700 mb-8 bg-yellow-50 p-4 rounded-2xl text-left italic text-xs border border-yellow-100"></div>
                <button onclick="restartGame()" class="w-full bg-yellow-400 text-yellow-900 font-bold py-3.5 rounded-2xl shadow-lg btn-bounce">å†æ¬¡æŒ‘æˆ°</button>
            </div>
        </div>
    </div>

    <script>
        // æ°´æ™¶éŸ³æ¨‚åˆæˆå™¨
        let audioCtx = null;
        let isPlaying = false;
        let nextNoteTime = 0;
        let melodyIndex = 0;
        let timerId = null;
        const melody = [261.63, 261.63, 392.00, 392.00, 440.00, 440.00, 392.00, 349.23, 349.23, 329.63, 329.63, 293.66, 293.66, 261.63];

        function playNote(freq, time) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, time);
            gain.gain.setValueAtTime(0, time);
            gain.gain.linearRampToValueAtTime(0.12, time + 0.05);
            gain.gain.exponentialRampToValueAtTime(0.001, time + 1.2);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(time);
            osc.stop(time + 1.2);
        }

        function scheduler() {
            while (nextNoteTime < audioCtx.currentTime + 0.1) {
                playNote(melody[melodyIndex], nextNoteTime);
                nextNoteTime += 0.85;
                melodyIndex = (melodyIndex + 1) % melody.length;
            }
            timerId = setTimeout(scheduler, 25);
        }

        function toggleMusic() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (!isPlaying) {
                isPlaying = true;
                if (audioCtx.state === 'suspended') audioCtx.resume();
                nextNoteTime = audioCtx.currentTime;
                melodyIndex = 0;
                scheduler();
                document.getElementById('music-icon').innerText = 'ğŸµ';
                document.getElementById('music-toggle').classList.add('music-pulse');
                document.getElementById('bed-mobile').classList.add('mobile-swing-active');
            } else {
                isPlaying = false;
                clearTimeout(timerId);
                document.getElementById('music-icon').innerText = 'ğŸ”‡';
                document.getElementById('music-toggle').classList.remove('music-pulse');
                document.getElementById('bed-mobile').classList.remove('mobile-swing-active');
            }
        }

        // æ¸¬é©—é¡Œåº«èˆ‡æ–‡ç« é—œè¯
        const articleList = {
            risk: { title: "æ¯å¹´30åå¬°å…’çŒæ­»ï¼Œç‚ºä½•æˆç‚ºè‡´å‘½é¢¨éšªï¼Ÿ", url: "https://premium.parenting.com.tw/article/6001803" },
            myths: { title: "ä¸€æ¬¡ç ´è§£5å¤§å¯¶å¯¶ç¡çœ è¿·æ€èˆ‡é¢¨éšªè¡Œç‚º", url: "https://premium.parenting.com.tw/article/6001757" },
            practical: { title: "6æ‹›è®“é›£å“„å¯¶å¯¶ä¹Ÿå¥½ç¡ï¼šå®‰å…¨ä¹Ÿå¥½çœ ", url: "https://premium.parenting.com.tw/article/6001733" },
            reform: { title: "å°ˆå®¶æ3å¤§é—œéµæ”¹é©ï¼Œé™ä½å¬°å…’çŒæ­»æ©Ÿç‡", url: "https://premium.parenting.com.tw/article/6001805" },
            story: { title: "å¤±å»å­©å­çš„æ¯è¦ªç¨ç™½ï¼šé€™æ˜¯æˆ‘æœ€å¾Œèƒ½ç‚ºä½ åšçš„", url: "https://premium.parenting.com.tw/article/6001793" },
            intl: { title: "å€Ÿé¡è‹±å¥§æ¾³ï¼Œæ‰“é€ å…¨æ–¹ä½ç¡çœ å®‰å…¨ç¶²", url: "https://premium.parenting.com.tw/article/6001802" }
        };

        const questions = [
            { q: "ç‚ºä½•è¨±å¤šå®¶é•·æ˜çŸ¥è¶´ç¡æœ‰é¢¨éšªï¼Œä»æƒ³è®“å¯¶å¯¶è¶´ç¡ï¼Ÿ", o: ["å¯ä»¥é˜²åå¥¶å™åˆ°", "å¯¶å¯¶è¶´è‘—æ¯”è¼ƒæœ‰å®‰å…¨æ„Ÿï¼Œç¡å¾—è¼ƒæ²‰", "èƒ½è®“é ­å‹è®Šæ¼‚äº®", "ä»¥ä¸Šçš†æ˜¯å¸¸è¦‹è¿·æ€"], a: 3, f: "è‡´å‘½è¿·æ€ï¼ç ”ç©¶é¡¯ç¤ºè¶´ç¡æœƒå¢åŠ çŒæ­»æ©Ÿç‡ï¼Œè€Œã€ç¡å¾—æ²‰ã€åè€Œæ˜¯åœæ­¢å‘¼å¸çš„é¢¨éšªä¾†æºã€‚", article: articleList.myths },
            { q: "åœ‹å¤–æ¨å»£å¬°å…’ç¡çœ å®‰å…¨ç¶²ï¼ˆå¦‚å¥§åœ°åˆ©ï¼‰çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ï¼Ÿ", o: ["å®¶é•·æ‡‰è©²æ›´åŠªåŠ›ç›£è¦–å¯¶å¯¶", "ç¡çœ å®‰å…¨æ˜¯ç¤¾æœƒç³»çµ±æ”¯æŒï¼Œéåƒ…å®¶é•·è²¬ä»»", "è²·åµæ¸¬å™¨æ˜¯å”¯ä¸€è§£æ–¹", "å¬°å…’ä¸æ‡‰åœ¨é†«é™¢å¤–ç¡è¦º"], a: 1, f: "ç¡çœ å®‰å…¨æ˜¯å…¨æ–¹ä½é˜²è­·ç¶²ï¼ŒåŒ…æ‹¬æ”¿åºœè£œåŠ©èˆ‡å®¶åº­æ”¯æŒã€‚", article: articleList.intl },
            { q: "é—œæ–¼ã€ŒåŒåºŠç¡ã€ï¼Œå°ˆå®¶æ­»å› å›æº¯å¾Œçš„å»ºè­°æ˜¯ï¼Ÿ", o: ["åŒåºŠæ›´å®‰å…¨ï¼Œèƒ½å³æ™‚ç™¼ç¾å•é¡Œ", "åŒåºŠæœƒå¢åŠ å¤§äººå£“åˆ°å­©å­æˆ–è¢«è¤¥é®å£é¼»çš„é¢¨éšª", "ä¸­é–“æ”¾æ•é ­éš”é–‹å°±å®‰å…¨", "ç‚ºäº†è¦ªå¯†é—œä¿‚ï¼Œä¸€å®šè¦åŒåºŠ"], a: 1, f: "æ­£ç¢ºåšæ³•æ˜¯ã€åŒæˆ¿ä¸åŒåºŠã€ã€‚åŒåºŠå®¹æ˜“ç™¼ç”Ÿæº¢å¥¶å™åˆ°æˆ–å£“è¿«æ„å¤–ã€‚", article: articleList.risk },
            { q: "ç•¶å¯¶å¯¶åŠå¤œå“­é¬§æ™‚ï¼Œå“ªç¨®è¡Œç‚ºæ˜¯æ­£ç¢ºçš„ï¼Ÿ", o: ["æ”¾åœ¨è»Ÿæ²™ç™¼ä¸Šæš«ç¡", "å¬°å…’åºŠå †æ»¿ç©å¶å¢åŠ å®‰å…¨æ„Ÿ", "å»ºç«‹å›ºå®šé †åºçš„ç¡çœ å„€å¼ä¸¦ä»°ç¡", "è®“ä»–è¶´åœ¨å¤§äººèƒ¸å£ç¡"], a: 2, f: "æ²™ç™¼æ¥µå±éšªã€‚åºŠæ‡‰ä¿æŒç©ºæ› ï¼Œäº”å­—è¨£ï¼šä¸ã€æ–ã€å¢Šã€æ•ã€è¢«ã€‚", article: articleList.reform },
            { q: "æ­»å› å›æº¯åˆ†æä¸­ï¼Œå“ªç¨®æƒ…æ³æœ€å®¹æ˜“å°è‡´æ„å¤–çª’æ¯ï¼Ÿ", o: ["åºŠæ—æ”¾ç©ºæ°£æ¸…æ·¨æ©Ÿ", "å¤§äººç–²æ†Šé¤µå¥¶ä¸æ…ç¡è‘—è€Œå£“åˆ°å­©å­", "æˆ¿é–“æº«ä½æ–¼24åº¦", "ä½¿ç”¨å¤ªç¡¬çš„åºŠå¢Š"], a: 1, f: "å®¶é•·éåº¦ç–²æ†Šæ˜¯æ½›åœ¨é¢¨éšªï¼Œé¤µå¥¶æ™‚ç¡è‘—å¸¸å°è‡´å­©å­å—å£“ã€‚", article: articleList.risk },
            { q: "ä¸€æ­²ä»¥å…§ï¼Œå¬°å…’åºŠå…§å”¯ä¸€ã€Œå®‰å…¨ã€çš„æ±è¥¿æ˜¯ï¼Ÿ", o: ["æŸ”è»Ÿæ¯›æ¯¯", "é˜²æ’åºŠåœ", "é©ç•¶ä½¿ç”¨çš„å¥¶å˜´", "éŸ³æ¨‚éˆ´"], a: 2, f: "å¥¶å˜´æœ‰åŠ©æ”¾é¬†ä¸”é™ä½çŒæ­»æ©Ÿç‡ã€‚æ•é ­èˆ‡åºŠåœéƒ½æ˜¯å¤šé¤˜çš„éšœç¤™ç‰©ã€‚", article: articleList.practical },
            { q: "é—œæ–¼æº«åº¦çš„å®‰å…¨åŸå‰‡æ˜¯ï¼Ÿ", o: ["ç©¿è¶Šå¤šè¶Šå¥½", "ç’°å¢ƒé€šé¢¨ã€é¿å…å¯¶å¯¶éç†±", "æ‰‹è…³å†°æ¶¼æ‰æ­£å¸¸", "å†·æ°£é–‹åˆ°28åº¦"], a: 1, f: "éç†±æ˜¯çŒæ­»å› å­ã€‚ç’°å¢ƒæ‡‰æ¶¼çˆ½ï¼Œç©¿è¡£ä»¥å¯¶å¯¶é ¸å¾Œæº«æš–ç‚ºæº–ã€‚", article: articleList.reform },
            { q: "ç‚ºä»€éº¼å¬°å…’ç¡çœ æœƒæœ‰ã€ŒåŠå¤¢åŠé†’ã€çš„å¸¸æ…‹ï¼Ÿ", o: ["ç”Ÿç—…äº†", "æ²’ç¡å¥½", "æ·ºçœ æœŸå¤§æ–¼ç†Ÿç¡æœŸæ˜¯ç™¼å±•å¸¸æ…‹", "è‚šå­é¤“"], a: 2, f: "å¬°å…’æ·ºçœ æœŸé•·æ˜¯ç”Ÿç†å¸¸æ…‹ï¼Œäº†è§£é€™é»èƒ½æ¸›å°‘å®¶é•·ç„¦æ…®ã€‚", article: articleList.practical },
            { q: "å°æ–¼ã€Œé›£å“„å‹ã€å¯¶å¯¶ï¼Œå“ªç¨®å¦™æ‹›èƒ½å…¼é¡§å®‰å…¨ï¼Ÿ", o: ["è®“ä»–è¶´ç¡", "ç™½å™ªéŸ³èˆ‡å´æŠ±å¾Œè½‰ä»°èºº", "æç±ƒç¡æ•´æ™š", "å¥¶å˜´åŠ æ›ç¹©"], a: 1, f: "å¯ä»¥å´æŠ±å®‰æ’«ï¼Œä½†å…¥ç¡æ”¾å…¥åºŠå¾Œå‹™å¿…è½‰ç‚ºã€ä»°èººã€ã€‚æ›ç¹©çµ•å°åš´ç¦ã€‚", article: articleList.practical },
            { q: "å®‰å…¨ç¡çœ çš„é—œéµã€Œä¸‰ä¸ã€ä¸åŒ…å«ä¸‹åˆ—ä½•è€…ï¼Ÿ", o: ["ä¸è¶´ç¡", "ä¸ä½¿ç”¨é¬†è»Ÿå¯¢å…·", "ä¸è®“å¯¶å¯¶å–®ç¨æˆ¿é–“ç¡", "ä¸è½ä»»ä½•è²éŸ³"], a: 3, f: "å°ˆå®¶å»ºè­°ã€åŒæˆ¿ä¸åŒåºŠã€ã€‚é©åº¦ç™½å™ªéŸ³æ˜¯å¯ä»¥æ¥å—çš„ã€‚", article: articleList.story }
        ];

        let currentQ = 0;
        let score = 0;

        function setBaby(state) {
            const wrap = document.getElementById('baby-wrapper');
            const map = { neutral:['eyes-neutral','mouth-neutral'], happy:['eyes-happy','mouth-happy','hearts-layer'], sad:['eyes-sad','mouth-sad','tears-layer'] };
            Object.values(map).flat().forEach(id => document.getElementById(id).classList.add('hidden'));
            wrap.classList.remove('is-crying');
            map[state].forEach(id => document.getElementById(id).classList.remove('hidden'));
            if(state==='sad') wrap.classList.add('is-crying');
        }

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            if(!isPlaying) toggleMusic();
            showQ();
        }

        function showQ() {
            setBaby('neutral');
            const q = questions[currentQ];
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('progress-text').innerText = `é€²åº¦ ${currentQ + 1} / 10`;
            document.getElementById('progress-bar').style.width = `${(currentQ+1)*10}%`;
            
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            document.getElementById('feedback-container').classList.add('hidden');

            q.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.innerText = opt;
                btn.className = "w-full text-left p-3.5 rounded-xl border-2 border-pink-50 hover:bg-pink-50 transition text-sm btn-bounce";
                btn.onclick = () => check(i);
                container.appendChild(btn);
            });
            document.getElementById('quiz-content').scrollTop = 0;
        }

        function check(i) {
            const q = questions[currentQ];
            const btns = document.getElementById('options-container').querySelectorAll('button');
            btns.forEach(b => b.disabled = true);
            const isCorrect = i === q.a;
            if(isCorrect) {
                score += 100; setBaby('happy');
                document.getElementById('score-text').innerText = `å¾—åˆ†: ${score}`;
                document.getElementById('feedback-title').innerText = "æ­£ç¢ºå®ˆè­·ï¼";
                document.getElementById('feedback-container').className = "p-4 rounded-2xl border-2 border-green-200 bg-green-50 fade-in mb-4";
                document.getElementById('feedback-icon').innerHTML = "âœ…";
                btns[i].classList.add('border-green-500', 'bg-green-100');
            } else {
                setBaby('sad');
                document.getElementById('feedback-title').innerText = "å®‰å…¨æ¼æ´ï¼";
                document.getElementById('feedback-container').className = "p-4 rounded-2xl border-2 border-red-200 bg-red-50 fade-in mb-4";
                document.getElementById('feedback-icon').innerHTML = "âš ï¸";
                btns[i].classList.add('border-red-500', 'bg-red-100');
                btns[q.a].classList.add('border-green-500', 'bg-green-50');
            }
            document.getElementById('feedback-text').innerText = q.f;
            
            // å»¶ä¼¸é–±è®€
            const artDiv = document.getElementById('inline-article');
            const artLink = document.getElementById('article-link');
            if(q.article) {
                artDiv.classList.remove('hidden');
                artLink.href = q.article.url;
                artLink.innerText = q.article.title;
            } else {
                artDiv.classList.add('hidden');
            }
            document.getElementById('feedback-container').classList.remove('hidden');
            setTimeout(() => { document.getElementById('quiz-content').scrollTo({top:999, behavior:'smooth'}); }, 100);
        }

        function nextQuestion() {
            currentQ++;
            if(currentQ < 10) showQ();
            else finish();
        }

        function finish() {
            // ç™¼é€ GTM è‡ªè¨‚äº‹ä»¶ aitool_success
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({ 'event': 'aitool_success' });

            document.getElementById('quiz-screen').classList.add('hidden');
            const res = document.getElementById('result-screen');
            res.classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            
            const badge = document.getElementById('rank-badge');
            const desc = document.getElementById('rank-desc');
            const msg = document.getElementById('result-message');

            if(score === 1000) {
                setBaby('happy'); badge.innerText = "ğŸ‘‘ çµ‚æ¥µå®ˆè­·ç¥";
                badge.className = "px-5 py-1.5 rounded-full bg-yellow-400 text-yellow-900 border-2 border-yellow-500 font-bold mb-2 inline-block";
                desc.innerText = "å®Œç¾é€šé—œï¼å¯¶å¯¶åœ¨ä½ èº«é‚Šæœ€å®‰å¿ƒï¼";
                msg.innerText = "å®‰å…¨æ˜¯ä¸å¯å¦¥å”çš„å‰æã€‚é€™ä»½å …æŒæ˜¯é€çµ¦å­©å­æœ€å¥½çš„ç¦®ç‰©ã€‚";
            } else if (score >= 700) {
                setBaby('happy'); badge.innerText = "ğŸŒŸ è³‡æ·±å®ˆè­·è€…";
                badge.className = "px-5 py-1.5 rounded-full bg-pink-100 text-pink-600 border-2 border-pink-300 font-bold mb-2 inline-block";
                desc.innerText = "éå¸¸æ£’ï¼ä½ æ˜¯å¯¶å¯¶ç©©å›ºçš„å®‰å¿ƒé å±±ã€‚";
                msg.innerText = "é›–ç„¶åªæœ‰å°‘æ•¸è¿·æ€ï¼Œä½†åœ¨ç¡çœ å®‰å…¨ä¸Šï¼Œç´°ç¯€æ±ºå®šå‘½é‹ã€‚";
            } else {
                setBaby('neutral'); badge.innerText = "ğŸ›¡ï¸ åˆéšå®ˆè­·è€…";
                badge.className = "px-5 py-1.5 rounded-full bg-gray-100 text-gray-600 border-2 border-gray-300 font-bold mb-2 inline-block";
                desc.innerText = "å…·å‚™åŸºç¤ï¼Œä½†éœ€ç ´é™¤è¶´ç¡ç­‰è‡´å‘½è¿·æ€ã€‚";
                msg.innerText = "ç‚ºäº†å¯¶å¯¶å¹³å®‰ï¼Œè«‹å‹™å¿…è©³è®€æ¸¬é©—ä¸­çš„å„é …è©³è§£æ–‡ç« ã€‚";
            }
        }

        function restartGame() {
            currentQ = 0; score = 0;
            document.getElementById('score-text').innerText = `å¾—åˆ†: 0`;
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
            setBaby('neutral');
        }
    </script>
</body>
</html>
